Note: This snippet uses CommonJS exports, we can UMD-ify it later if neccessary
